(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();class d{constructor(){this.p1StartLife=20,this.p2StartLife=20,this.p1Life=20,this.p2Life=20,this.history=[],this.p1Color=this.randomColor(),this.p2Color=this.randomColor(this.p1Color),this.p1Change=0,this.p2Change=0,this.changeTimeoutP1=null,this.changeTimeoutP2=null,this.historyBufferP1=0,this.historyBufferP2=0,this.historyTimeoutP1=null,this.historyTimeoutP2=null}randomColor(e=null){let t;do t=Math.floor(Math.random()*360);while(e!==null&&Math.abs(t-e)<160&&Math.abs(t-e)>200);return`hsl(${t}, 85%, 50%)`}updateLife(e,t){e===1?(this.p1Life+=t,this.p1Change+=t,this.historyBufferP1+=t,this.showChange(1),this.scheduleHistory(1)):(this.p2Life+=t,this.p2Change+=t,this.historyBufferP2+=t,this.showChange(2),this.scheduleHistory(2)),this.render()}scheduleHistory(e){const t=`historyTimeoutP${e}`,o=`historyBufferP${e}`;this[t]&&clearTimeout(this[t]),this[t]=setTimeout(()=>{const s=this[o];s!==0&&(this.history.push({player:e,amount:s,newLife:e===1?this.p1Life:this.p2Life,timestamp:new Date().toLocaleTimeString()}),this[o]=0,this.render())},2e3)}showChange(e){const t=document.getElementById(`p${e}-change`),o=e===1?this.p1Change:this.p2Change;t.textContent=(o>0?"+":"")+o,t.classList.add("show");const s=`changeTimeoutP${e}`;this[s]&&clearTimeout(this[s]),this[s]=setTimeout(()=>{t.classList.remove("show"),e===1?this.p1Change=0:this.p2Change=0},3e3)}reset(){this.p1Life=this.p1StartLife,this.p2Life=this.p2StartLife,this.history=[],this.p1Change=0,this.p2Change=0,this.render()}setStartLife(e,t){e===1?this.p1StartLife=parseInt(t):this.p2StartLife=parseInt(t),this.reset()}render(){document.getElementById("p1-life").textContent=this.p1Life,document.getElementById("p2-life").textContent=this.p2Life;const e=document.documentElement;e.style.setProperty("--p1-color",this.p1Color),e.style.setProperty("--p2-color",this.p2Color);const t=document.getElementById("history-list");t.innerHTML=this.history.slice().reverse().map(o=>`
            <div class="history-entry">
                <span class="history-p${o.player}">Player ${o.player}</span>
                <span>${o.amount>0?"+":""}${o.amount}</span>
                <span>${o.newLife} HP</span>
                <span style="opacity: 0.5">${o.timestamp}</span>
            </div>
        `).join("")}}const a=new d;document.querySelectorAll(".adjust-btn").forEach(i=>{i.addEventListener("click",e=>{const t=parseInt(i.dataset.player),o=parseInt(i.dataset.amount);a.updateLife(t,o);const s=document.getElementById(`p${t}-life`);s.classList.remove("pop"),s.offsetWidth,s.classList.add("pop")})});const n={history:document.getElementById("history-modal"),settings:document.getElementById("settings-modal"),reset:document.getElementById("reset-modal")};document.getElementById("history-btn").addEventListener("click",()=>{n.history.classList.add("active")});document.getElementById("settings-btn").addEventListener("click",()=>{n.settings.classList.add("active")});document.getElementById("reset-btn").addEventListener("click",()=>{n.reset.classList.add("active")});document.getElementById("confirm-reset").addEventListener("click",()=>{a.reset(),n.reset.classList.remove("active")});document.getElementById("cancel-reset").addEventListener("click",()=>{n.reset.classList.remove("active")});document.querySelectorAll(".close-modal").forEach(i=>{i.addEventListener("click",()=>{Object.values(n).forEach(e=>e.classList.remove("active"))})});window.addEventListener("click",i=>{Object.values(n).forEach(e=>{i.target===e&&e.classList.remove("active")})});document.querySelectorAll(".start-life-btn").forEach(i=>{i.addEventListener("click",()=>{const e=parseInt(i.dataset.player);document.querySelectorAll(`.start-life-btn[data-player="${e}"]`).forEach(t=>t.classList.remove("active")),i.classList.add("active"),a.setStartLife(e,i.dataset.value)})});document.querySelectorAll(".custom-life").forEach(i=>{i.addEventListener("change",e=>{const t=parseInt(i.dataset.player);a.setStartLife(t,e.target.value)})});let c=null;const l=async()=>{if("wakeLock"in navigator)try{c=await navigator.wakeLock.request("screen"),console.log("Wake Lock is active"),c.addEventListener("release",()=>{console.log("Wake Lock has been released"),c=null})}catch(i){console.error(`${i.name}, ${i.message}`)}};document.addEventListener("visibilitychange",async()=>{c===null&&document.visibilityState==="visible"&&await l()});document.addEventListener("click",l,{once:!0});document.addEventListener("touchstart",l,{once:!0});l();a.render();
